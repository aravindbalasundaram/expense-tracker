{% extends 'base.html' %}
{% block content %}
<h2 class="mb-3">ðŸ’° All Transactions</h2>

<form class="row g-3 mb-3" method="get">
  <div class="col-auto">
    <label>From:</label>
    <input type="date" class="form-control" name="start_date" value="{{ start_date }}">
  </div>
  <div class="col-auto">
    <label>To:</label>
    <input type="date" class="form-control" name="end_date" value="{{ end_date }}">
  </div>
  <div class="col-auto mt-4">
    <button type="submit" class="btn btn-primary">Filter</button>
    <a href="{{ url_for('index') }}" class="btn btn-secondary">Reset</a>
  </div>
</form>

{% if expenses %}
<table class="table table-striped">
  <thead>
    <tr>
      <th>Date</th>
      <th>Type</th>
      <th>Category</th>
      <th>Amount (â‚¹)</th>
      <th>Description</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    {% for e in expenses %}
    <tr class="{% if e.type == 'Credit' %}table-success{% else %}table-danger{% endif %}">
      <td>{{ e.date }}</td>
      <td>{{ e.type }}</td>
      <td>{{ e.category }}</td>
      <td>{{ "%.2f"|format(e.amount) }}</td>
      <td>{{ e.description }}</td>
      <td>
        <a href="{{ url_for('edit_expense', id=e.id) }}" class="btn btn-sm btn-warning">Edit</a>
        <a href="{{ url_for('delete_expense', id=e.id) }}" class="btn btn-sm btn-danger"
           onclick="return confirm('Delete this entry?');">Delete</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<div class="alert alert-info mt-3">
  <strong>Total Income:</strong> â‚¹{{ "%.2f"|format(income) }}<br>
  <strong>Total Expense:</strong> â‚¹{{ "%.2f"|format(spending) }}<br>
  <strong>Balance:</strong> â‚¹{{ "%.2f"|format(balance) }}
</div>

{% else %}
<p>No transactions found for this date range.</p>
{% endif %}
{% endblock %}
